<div class="sidebar">
  <div class="sidebar-inner">
    <div class="logo-container">
      <i class="fas fa-database logo-icon"></i>
      <h1 class="logo-text">ChartBot SQL</h1>
      <button class="sidebar-toggle-btn" (click)="toggleSidebar.emit()">
        <i class="fas fa-chevron-left"></i>
      </button>
    </div>

    <div class="sidebar-section">
      <div class="section-header">
        <h3 class="sidebar-title">CHATS</h3>
        <button class="new-chat-btn" (click)="createNewChat()" [disabled]="isLoadingSessions()">
          <i class="fas fa-plus"></i>
          <span>New Chat</span>
        </button>
      </div>
      
      <div class="chat-sessions-list">
        <div class="loading-sessions" *ngIf="isLoadingSessions()">
          <i class="fas fa-spinner fa-spin"></i>
          <span>Loading chats...</span>
        </div>
        
        <div class="empty-sessions" *ngIf="!isLoadingSessions() && chatSessions().length === 0">
          <i class="fas fa-comments"></i>
          <span>No chat sessions yet</span>
          <small>Click "New Chat" to start</small>
        </div>
        
        <div
          class="chat-session-item"
          *ngFor="let session of chatSessions()"
          [class.active]="currentSessionId() === session.id"
          (click)="switchToSession(session.id)"
        >
          <div class="session-info">
            <div class="session-title">{{ session.title }}</div>
            <div class="session-meta">
              <span class="message-count">{{ session.message_count }} messages</span>
              <span class="session-time">{{ formatSessionTime(session.updated_at) }}</span>
            </div>
          </div>
          <button 
            class="delete-session-btn" 
            (click)="deleteSession(session.id, $event)"
            title="Delete chat session"
          >
            <i class="fas fa-trash"></i>
          </button>
        </div>
      </div>
    </div>

    <div class="sidebar-section">
      <h3 class="sidebar-title">QUICK ACTIONS</h3>
      <button class="sidebar-btn" (click)="onExportClick()">
        <i class="fas fa-file-export"></i>
        <span class="btn-text">Export</span>
      </button>
    </div>

    <div class="sidebar-section">
      <h3 class="sidebar-title">SQL EXAMPLES</h3>
      <div class="sql-examples">
        <button
          class="sql-example-btn"
          *ngFor="let example of exampleQueries"
          (click)="selectExampleQuery(example.query)"
        >
          <i class="fas fa-table"></i>
          <span>{{ example.label }}</span>
        </button>
      </div>
    </div>

    <div class="sidebar-section">
      <div class="section-header">
        <h3 class="sidebar-title">QUERY HISTORY</h3>
        <button class="clear-history" (click)="clearHistory()">Clear</button>
      </div>
      <div class="history-list">
        <div class="empty-history" *ngIf="history.length === 0">
          <i class="fas fa-history"></i>
          <span>No query history yet</span>
        </div>
        <div
          class="history-item"
          *ngFor="let item of history"
          [title]="item.fullQuery"
          (click)="selectedQuery.set(item.fullQuery)"
        >
          <i class="fas fa-{{ item.type === 'sql' ? 'database' : 'chart-bar' }}"></i>
          <span>{{ item.query }}</span>
        </div>
      </div>
    </div>

    <div class="sidebar-footer">
      <div class="database-status">
        <div class="status-indicator">
          <div class="status-dot online"></div>
          <span>PostgreSQL Connected</span>
        </div>
      </div>
    </div>
  </div>
</div>